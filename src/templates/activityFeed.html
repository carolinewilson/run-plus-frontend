<section>
  <header>
    <ul>
      <li>
        <a ui-sref="plansShow({ id: stravaIndex.planId})">
          <img src="../images/arrow-left.png" class="left-arrow">
        </a>
      </li>
      <li>ACTIVITY FEED</li>
    </ul>
  </header>
  <button ng-click="stravaIndex.sync()">SYNC WITH STRAVA</button>
  <ul>
    <li ng-repeat="activity in stravaIndex.allActivities | orderBy: 'date'" >
      <div ng-if="activity.exercise">
        <h3>{{activity.date | date: dd}}</h3>
        <p>{{activity.exercise.name}}</p>
        <button ui-sref="daysShow({planId: stravaIndex.planId, dayId: activity.id})">View Day</button>
      </div>
      <div ng-if="!activity.exercise">
        <h3>{{ activity.start_date | date: dd}}</h3>
        <div ng-if="activity.userDay">
          <p ng-if="!activity.userDay.exercise">REST DAY</p>
          <p ng-if="activity.userDay.exercise">{{ activity.userDay.exercise.name }}</p>
          <button ng-if="activity.userDay.strava_id" ui-sref="daysShow({planId: stravaIndex.planId, dayId: activity.userDay.id, stravaId: activity.userDay.strava_id})">View Run</button>
          <button ng-if="activity.userDay.exercise && !activity.userDay.strava_id" ng-click="stravaIndex.markComplete({planId: stravaIndex.planId, dayId: activity.userDay.id, stravaId: activity.id})">Mark completed</button>
        </div>

        <p>{{ activity.name }}<span ng-if="activity.location_city">, {{ activity.location_city }}</span></p>
        <p>{{ activity.distance }} mi</p>
        <p>{{ activity.elapsed_hours }}:{{ activity.elapsed_minutes }}:{{ activity.elapsed_seconds}}</p>
        <div ng-if="activity.map.summary_polyline" class="map-summary">
          <google-map ng-if="activity.map.summary_polyline" data="activity.map.summary_polyline" ></google-map>
        </div>

      </div>
    </li>
  </ul>
</section>
